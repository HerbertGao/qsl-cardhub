# 提案：过滤隐藏配置文件

## 概述

在配置管理系统中添加对隐藏配置文件的过滤支持，使得以 `.` 开头的配置文件不会被加载到用户可见的配置列表中。同时，将示例配置文件 `example.toml` 重命名为 `.example.toml`，避免其出现在用户的配置列表中。

## 为什么

当前的配置管理系统会将所有 `.toml` 文件加载到用户的配置列表中，包括示例配置文件。这导致用户困惑，因为他们看到了不属于自己创建的配置。通过采用 Unix/Linux 的隐藏文件约定（以 `.` 开头），我们可以提供示例配置文件供用户参考，同时不污染用户的配置列表。这是一个简单、标准且用户熟悉的解决方案。

## 动机

### 问题描述

当前的 `ProfileManager::get_all()` 方法会加载 `profiles/` 目录下所有扩展名为 `.toml` 的文件，包括示例配置文件。这导致：

1. **用户困惑**: 示例配置文件 `example.toml` 会出现在用户的配置列表中，但用户可能不希望使用或看到它
2. **命名空间污染**: 无法提供示例配置而不影响用户的配置列表
3. **缺乏隐藏机制**: 没有标准的方式来标记某些配置文件为"系统文件"或"示例文件"

### 解决方案

采用 Unix/Linux 系统的通用约定：以 `.` 开头的文件为隐藏文件。

**具体措施：**
1. 在 `ProfileManager::get_all()` 中添加文件名过滤逻辑，跳过以 `.` 开头的文件
2. 将 `config/profiles/example.toml` 重命名为 `config/profiles/.example.toml`
3. 确保所有读取配置文件的代码路径都遵循此约定

## 范围

### 包含
- ✅ 修改 `ProfileManager::get_all()` 方法，过滤以 `.` 开头的文件名
- ✅ 重命名 `config/profiles/example.toml` → `config/profiles/.example.toml`
- ✅ 验证修改后配置列表功能正常
- ✅ 确保示例文件仍然可以被直接读取（通过路径）

### 不包含
- ❌ 修改其他配置文件格式或结构
- ❌ 添加新的配置管理 API
- ❌ 修改前端展示逻辑（后端过滤即可）

## 影响分析

### 受影响的组件
1. **后端 - ProfileManager** (`src/config/profile_manager.rs`)
   - `get_all()` 方法需要添加文件名过滤

2. **配置文件** (`config/profiles/`)
   - 重命名 `example.toml` → `.example.toml`

3. **测试**
   - 需要验证隐藏文件不会被加载
   - 需要验证正常文件仍然被加载

### 不受影响的组件
- 前端代码（后端过滤，前端无感知）
- Tauri 命令层（API 签名不变）
- 数据库或持久化逻辑（仅文件系统过滤）

## 风险评估

### 低风险
- **向后兼容**: 现有的非隐藏配置文件不受影响
- **文件系统**: 仅涉及文件重命名和读取逻辑
- **测试覆盖**: 变更范围小，容易测试

### 潜在问题
1. **文档更新**: 需要更新文档，说明示例文件现在是隐藏的
2. **用户迁移**: 如果用户手动复制了 `example.toml`，需要告知他们新的示例文件位置

## 验收标准

### 功能验收
1. ✅ 调用 `ProfileManager::get_all()` 不返回 `.example.toml`
2. ✅ 调用 `ProfileManager::get_all()` 仍然返回其他正常的 `.toml` 文件
3. ✅ 可以通过 `ProfileManager::get_by_id()` 直接读取 `.example.toml`（如果需要）
4. ✅ 文件系统中存在 `.example.toml`，不存在 `example.toml`

### 测试验收
1. ✅ 添加单元测试验证隐藏文件过滤逻辑
2. ✅ 添加单元测试验证正常文件仍然被加载
3. ✅ 所有现有测试通过

## 实现计划

详见 `tasks.md`

## 相关文档

- [ProfileManager 源码](../../src/config/profile_manager.rs)
- [配置目录](../../config/profiles/)
